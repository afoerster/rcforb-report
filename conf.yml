---
database_path: Database.db
reports:
  - name: session_length_graph
    decscription: The length, in 5 minute increments, of every login session
    query: > 

      with logouts as
              (select name, ip, date as logout_date, cast(reply as int) as reply from radio_logs where command = 'disconnect'
              and date BETWEEN datetime('now', '-30 days') AND datetime('now', 'localtime'))
      select name,
       ip,
       logout_date,
       '*' || substr(
               '*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************',
               0, reply / 5
           ) as time
       from logouts order by logout_date desc
  - name: top_10_logins.csv
    description: Top users by number of logins
    query: select name, count(*) as num_logins from logins group by name order by count(*) desc limit 10
  - name: last_100_command.csv
    description: Most recent commands run
    query: select name, date, command from radio_logs order by date desc limit 100
  - name: top_100_commands.csv
    description: Most common commands
    query: select command, count(*) as count from radio_logs group by command order by count(*) desc limit 100
  - name: total_logins.csv
    description: Total number of logins all-time
    query: select count(*) as num_logins from logins
  - name: logins_last_30_days.csv
    description: All logins in the last 30 days
    query: select name, ip, date, denied, reason from logins where date > date('now', '-30 days') order by date desc;

